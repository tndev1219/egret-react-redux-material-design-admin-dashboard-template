(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{1424:function(e,t,a){"use strict";var n=a(5),r=a(3),c=a(1),o=a.n(c),s=(a(0),a(9)),i=a(12),l=a(627),m=a(20),d=o.a.forwardRef(function(e,t){var a=e.children,c=e.classes,i=e.className,d=e.color,u=void 0===d?"default":d,p=e.component,h=void 0===p?"button":p,f=e.disabled,b=void 0!==f&&f,g=e.disableFocusRipple,v=void 0!==g&&g,x=e.focusVisibleClassName,E=e.size,y=void 0===E?"large":E,N=e.variant,C=void 0===N?"round":N,w=Object(n.a)(e,["children","classes","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"]);return o.a.createElement(l.a,Object(r.a)({className:Object(s.a)(c.root,i,"round"!==C&&c.extended,"large"!==y&&c["size".concat(Object(m.a)(y))],b&&c.disabled,{primary:c.primary,secondary:c.secondary,inherit:c.colorInherit}[u]),component:h,disabled:b,focusRipple:!v,focusVisibleClassName:Object(s.a)(c.focusVisible,x),ref:t},w),o.a.createElement("span",{className:c.label},a))});t.a=Object(i.a)(function(e){return{root:Object(r.a)({},e.typography.button,{boxSizing:"border-box",minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,boxShadow:e.shadows[6],"&:active":{boxShadow:e.shadows[12]},color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],"&$focusVisible":{boxShadow:e.shadows[6]},"&:hover":{backgroundColor:e.palette.grey.A100,"@media (hover: none)":{backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground},textDecoration:"none"},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},primary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},secondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},extended:{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48,"&$sizeSmall":{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"&$sizeMedium":{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40}},focusVisible:{},disabled:{},colorInherit:{color:"inherit"},sizeSmall:{width:40,height:40},sizeMedium:{width:48,height:48}}},{name:"MuiFab"})(d)},1435:function(e,t,a){"use strict";var n=a(3),r=a(5),c=a(1),o=a.n(c),s=(a(0),a(9)),i=a(12),l=o.a.forwardRef(function(e,t){var a=e.alt,c=e.children,i=e.childrenClassName,l=e.classes,m=e.className,d=e.component,u=void 0===d?"div":d,p=e.imgProps,h=e.sizes,f=e.src,b=e.srcSet,g=Object(r.a)(e,["alt","children","childrenClassName","classes","className","component","imgProps","sizes","src","srcSet"]),v=null,x=f||b;return v=x?o.a.createElement("img",Object(n.a)({alt:a,src:f,srcSet:b,sizes:h,className:l.img},p)):i&&o.a.isValidElement(c)?o.a.cloneElement(c,{className:Object(s.a)(i,c.props.className)}):c,o.a.createElement(u,Object(n.a)({className:Object(s.a)(l.root,l.system,m,!x&&l.colorDefault),ref:t},g),v)});t.a=Object(i.a)(function(e){return{root:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),borderRadius:"50%",overflow:"hidden",userSelect:"none"},colorDefault:{color:e.palette.background.default,backgroundColor:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[600]},img:{width:"100%",height:"100%",textAlign:"center",objectFit:"cover"}}},{name:"MuiAvatar"})(l)},2247:function(e,t,a){"use strict";a.r(t);var n=a(8),r=a(16),c=a(30),o=a(35),s=a(39),i=a(38),l=a(40),m=a(1),d=a.n(m),u=a(1381),p=a(11),h=a(27),f=a.n(h),b=function(e){return f.a.get("/api/chat/contacts",{data:e})},g=function(e){return f.a.get("/api/chat/contacts/recent",{data:e})},v=function(e,t){return f.a.get("/api/chat/chat-room",{data:{currentUser:e,contactId:t}})},x=function(e){return f.a.post("/api/chat/add",e)},E=a(1435),y=a(1329),N=Object(y.a)({avatar:{height:"40px",width:"40px"},status_circle:{position:"absolute",height:"14px",width:"14px",borderRadius:"7px",bottom:"0px",right:"-3px",border:"2px solid white"}})(function(e){var t=e.src,a=e.status,n=e.classes;return d.a.createElement("div",{className:"chat-avatar position-relative"},d.a.createElement(E.a,{className:n.avatar,src:t}),d.a.createElement("div",{className:"".concat(n.status_circle," ").concat("online"===a?"bg-primary":"bg-error")}))}),C=a(1422),w=a.n(C),k=a(1382),S=a(2180),j=function(e){var t=e.currentUser,a=e.contactList,n=void 0===a?[]:a,r=e.recentContactList,c=void 0===r?[]:r,o=e.handleContactClick;return d.a.createElement("div",{className:"chat-sidenav bg-default"},d.a.createElement("div",{className:"chat-sidenav__topbar flex flex-middle h-56 px-16 bg-primary"},d.a.createElement(N,{src:t.avatar,status:t.status}),d.a.createElement("h5",{className:"ml-16 white-space-pre mb-0 font-weight-500 font-size-18 text-white"},t.name)),d.a.createElement(w.a,{className:"chat-contact-list position-relative h-400"},c.map(function(e,t){return d.a.createElement("div",{onClick:function(){return o(e.id)},key:t,className:"flex flex-middle p-16 cursor-pointer  gray-on-hover"},d.a.createElement(N,{src:e.avatar,status:e.status}),d.a.createElement("div",{className:"pl-16"},d.a.createElement("p",{className:"m-0"},e.name),d.a.createElement("p",{className:"m-0 text-muted"},Object(S.a)(new Date(e.lastChatTime).getTime(),"MMMM dd, yyyy"))))}),d.a.createElement(k.a,null),n.map(function(e,t){return d.a.createElement("div",{onClick:function(){return o(e.id)},key:t,className:"flex flex-middle px-16 py-4 cursor-pointer  gray-on-hover"},d.a.createElement(N,{src:e.avatar,status:e.status}),d.a.createElement("div",{className:"pl-16"},d.a.createElement("p",null,e.name)))})))},R=a(169),O=a(1330),L=a(1369),U=a(1437),z=a(604),M=a(1424),I=function(){return d.a.createElement("div",{className:"empty-message-circle bg-default flex flex-center flex-middle"},d.a.createElement(L.a,{color:"primary"},"chat"))},T=a(140),_=a(15),D=a.n(_),B=function(e){var t=e.id,a=e.toggleSidenav,n=e.currentChatRoom,r=e.opponentUser,c=e.messageList,o=void 0===c?[]:c,s=e.setBottomRef,i=e.handleMessageSend,l=d.a.useState(""),u=Object(R.a)(l,2),h=u[0],f=u[1];return d.a.createElement("div",{className:"chat-container flex-column position-relative"},d.a.createElement("div",{className:"chat-container__topbar flex flex-middle flex-space-between p-4 bg-primary"},d.a.createElement("div",{className:"flex flex-middle"},d.a.createElement("div",{className:"show-on-mobile"},d.a.createElement(O.a,{onClick:a},d.a.createElement(L.a,{className:"text-white"},"short_text"))),d.a.createElement("div",{className:"hide-on-mobile"},d.a.createElement("div",{className:"pl-12"})),r&&d.a.createElement(m.Fragment,null,d.a.createElement(N,{src:r.avatar,status:r.status}),d.a.createElement("h5",{className:"ml-16 white-space-pre mb-0 font-weight-500 font-size-18 text-white"},r.name))),d.a.createElement(p.i,{menuButton:d.a.createElement(O.a,null,d.a.createElement(L.a,{className:"text-white"},"more_vert"))},d.a.createElement(U.a,{className:"flex flex-middle"},d.a.createElement(L.a,{className:"mr-16"},"account_circle")," Contact"),d.a.createElement(U.a,{className:"flex flex-middle"},d.a.createElement(L.a,{className:"mr-16"},"volume_mute")," Mute"),d.a.createElement(U.a,{className:"flex flex-middle"},d.a.createElement(L.a,{className:"mr-16"},"delete")," Clear Chat"))),d.a.createElement(w.a,{containerRef:function(e){s(e)},className:"chat-message-list flex-grow-1 position-relative"},""===n&&d.a.createElement("div",{className:"flex-column flex-center flex-middle h-100"},d.a.createElement(I,null),d.a.createElement("p",null,"Select a contact")),o.map(function(e,a){return d.a.createElement("div",{className:"flex flex-top px-16 py-12",key:D.a.generate()},d.a.createElement(N,{src:e.avatar,status:e.status}),d.a.createElement("div",{className:"ml-16"},d.a.createElement("p",{className:"text-muted m-0 mb-8"},e.name),d.a.createElement("div",{className:"px-16 py-8 mb-4 list__message ".concat(t===e.contactId?"bg-primary text-white":"bg-paper")},d.a.createElement("span",{className:"white-space-pre-line"},e.text)),d.a.createElement("p",{className:"text-muted mb-0"},Object(T.e)(new Date(e.time))," ago")))})),d.a.createElement(k.a,null),""!==n&&d.a.createElement("div",{className:"flex flex-middle px-16 py-8"},d.a.createElement(z.a,{label:"Type your message here*",value:h,onChange:function(e){return f(e.target.value)},onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(""!==(h=h.trim())&&i(h),f(""))},fullWidth:!0,multiline:!0,rows:1}),d.a.createElement("div",null,d.a.createElement(M.a,{onClick:function(){""!==h.trim()&&i(h),f("")},color:"primary",className:"ml-16"},d.a.createElement(L.a,null,"send")))))},V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var o=arguments.length,l=new Array(o),m=0;m<o;m++)l[m]=arguments[m];return(a=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(l)))).state={currentUser:{id:"7863a6802ez0e277a0f98534"},contactList:[],recentContactList:[],messageList:[],currentChatRoom:"",opponentUser:null,open:!0},a.bottomRef=d.a.createRef(),a.updateRecentContactList=function(){var e=a.state.currentUser.id;g(e).then(function(e){a.setState({recentContactList:Object(r.a)(e.data)})})},a.scrollToBottom=function(){a.bottomRef.current.scrollIntoView({behavior:"smooth"})},a.handleContactClick=function(e){Object(T.g)()&&a.toggleSidenav(),b(e).then(function(e){var t=e.data;a.setState({opponentUser:Object(n.a)({},t)})}),v(a.state.currentUser.id,e).then(function(e){var t=e.data,n=t.chatId,r=t.messageList,c=t.recentListUpdated;console.log(n),a.setState({currentChatRoom:n,messageList:r},function(){a.bottomRef.scrollTop=9999999999999}),c&&a.updateRecentContactList()})},a.handleMessageSend=function(e){var t=a.state.currentUser.id,n=a.state,c=n.currentChatRoom,o=n.opponentUser;""!==c&&x({chatId:c,text:e,contactId:t,time:new Date}).then(function(e){a.setState({messageList:Object(r.a)(e.data)},function(){a.bottomRef.scrollTop=9999999999999}),setTimeout(function(){x({chatId:c,text:"Hi, I'm ".concat(o.name,". Your imaginary friend."),contactId:o.id,time:new Date}).then(function(e){a.setState({messageList:Object(r.a)(e.data)},function(){a.bottomRef.scrollTop=9999999999999})})},750)})},a.setBottomRef=function(e){a.bottomRef=e},a.toggleSidenav=function(){return a.setState({open:!a.state.open})},a}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e,t=this,a=this.state.currentUser.id;b(a).then(function(e){t.setState({open:!Object(T.g)(),currentUser:Object(n.a)({},e.data)})}),(e=this.state.currentUser.id,f.a.get("/api/chat/contacts/all",{data:e})).then(function(e){return t.setState({contactList:Object(r.a)(e.data)})}),this.updateRecentContactList()}},{key:"render",value:function(){var e=this.state,t=e.currentUser,a=e.contactList,n=e.recentContactList,r=e.messageList,c=e.opponentUser,o=e.currentChatRoom;return d.a.createElement("div",{className:"m-sm-30"},d.a.createElement("div",{className:"mb-sm-30"},d.a.createElement(p.a,{routeSegments:[{name:"Chat"}]})),d.a.createElement(u.a,{elevation:6},d.a.createElement(p.m,null,d.a.createElement(p.l,{width:"230px",open:this.state.open,toggleSidenav:this.toggleSidenav},d.a.createElement(j,{currentUser:t,contactList:a,recentContactList:n,handleContactClick:this.handleContactClick})),d.a.createElement(p.n,null,d.a.createElement(B,{id:t.id,opponentUser:c,messageList:r,currentChatRoom:o,setBottomRef:this.setBottomRef,handleMessageSend:this.handleMessageSend,toggleSidenav:this.toggleSidenav})))))}}]),t}(m.Component);t.default=V}}]);
//# sourceMappingURL=51.f874ec24.chunk.js.map